<!DOCTYPE HTML>
<html>
<head>
<meta charset="utf-8">
<meta name="renderer" content="webkit|ie-comp|ie-stand">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
<link rel="Bookmark" href="favicon.ico" >
<link rel="Shortcut Icon" href="favicon.ico" />
<!--[if lt IE 9]>
<script type="text/javascript" src="lib/html5.js"></script>
<script type="text/javascript" src="lib/respond.min.js"></script>
<![endif]-->
<link rel="stylesheet" type="text/css" href="static/h-ui/css/H-ui.min.css" />
<link rel="stylesheet" type="text/css" href="static/h-ui.admin/css/H-ui.admin.css" />
<link rel="stylesheet" type="text/css" href="lib/Hui-iconfont/1.0.8/iconfont.css" />
<link rel="stylesheet" type="text/css" href="static/h-ui.admin/skin/default/skin.css" id="skin" />
<link rel="stylesheet" type="text/css" href="static/h-ui.admin/css/style.css" />
	<link href="plug/layui/css/layui.css">

<!--[if IE 6]>
<script type="text/javascript" src="http://lib.h-ui.net/DD_belatedPNG_0.0.8a-min.js" ></script>
<script>DD_belatedPNG.fix('*');</script><![endif]-->
<!--/meta 作为公共模版分离出去-->

<title>管理员信息修改</title>
	<style>

		#main{
			width: 450px;
			overflow: hidden;
			margin: 0px auto;
		}

		#myform input[type=text], input[type=password],input[type=email]{
			width: 200px;
			border: 1px dashed #00B83F;
			border-radius: 3px;
			height: 28px;
			background:none;
			display: block;
			float: left;
			transition: all 0.5s ease-in-out;
		}
		#myform  input:focus{
			border-style: solid;
			border-color: orange;
		}
		#myform span{
			display: block;
			height: 30px;
		}
		.edit-msg{
			float: right;
			padding-right: 10px;
			color: orange;
		}
		#updatePassword{
			background-color: orange;
			border:none;
			color: white;
			transition: all 0.5s  ease;
			float: right;
			margin-top: -15px;
		}
		#updatePassword:hover{

			background-color: #FF7F24;
		}
		</style>
</head>
<body>
<article class="cl pd-20" id="main">
	<input class="btn btn-primary radius" type="button" id="updatePassword" value="修改密码" >
	<form class="form form-horizontal" id="myform" action="#">
		<div class="row cl" style="border-bottom: 1px dashed #ccc; margin-top: 17px;">
			<label class="form-label col-xs-4 col-sm-3" style="text-align: left;" > 用户名：</label>
			<span id="userName">user</span>
			<!--<input type="text"     id="userName"   value="dasd"   disabled readonly>-->
		</div>
		<div class="row cl" style="border-bottom: 1px dashed #ccc; margin-top: 17px;">
			<label class="form-label col-xs-4 col-sm-3"style="text-align: left;"> 真实姓名：</label>
			<!--<span id="trueName">user</span>-->
			<input type="text"  class="input-info"  id="trueName" name="trueName"  placeholder="真实姓名" required maxlength="4" minlength="2" >
			<span class="edit-msg">可修改</span>
		</div>
		<div class="row cl" style="border-bottom: 1px dashed #ccc; margin-top: 17px;">
			<label class="form-label col-xs-4 col-sm-3" style="text-align: left;">手机号码：</label>
			<!--<span id="phone">user</span>-->
			<input type="text"  class="input-info"   id="phone" name="phone"  placeholder="手机号码" required  maxlength="11" minlength="11">
			<span class="edit-msg">可修改</span>
		</div>
		<div class="row cl" style="border-bottom: 1px dashed #ccc; margin-top: 17px;">
			<label class="form-label col-xs-4 col-sm-3"style="text-align: left;"> 电子邮箱：</label>
			<!--<span id="email">user</span>-->
			<input type="email"  class="input-info"  id="email" name="email"  placeholder="电子邮箱"  required maxlength="30">
			<span class="edit-msg">可修改</span>
		</div>
		<div class="row cl" style="border-bottom: 1px dashed #ccc; margin-top: 17px;">
			<label class="form-label col-xs-4 col-sm-3"style="text-align: left;"> 创建时间：</label>
			<span id="createTime">user</span>
		</div>
		<div class="row cl" style="border-bottom: 1px dashed #ccc; margin-top: 17px;">
			<label class="form-label col-xs-4 col-sm-3" style="text-align: left;box-sizing: content-box;" > 上一次登录时间：</label>
			<span id="loginLastTime">user</span>
		</div>
		<div class="row cl" style="border-bottom: 1px dashed #ccc; margin-top: 17px;">
			<label class="form-label col-xs-4 col-sm-3" style="text-align: left;box-sizing: content-box;"> 最后登录时间：</label>
			<span id="lastTime">user</span>
		</div>
		<div class="row cl" style="border-bottom: 1px dashed #ccc; margin-top: 17px;">
			<label class="form-label col-xs-4 col-sm-3"style="text-align: left;"> 管理员权限：</label>
			<span id="permissions">user</span>
		</div>
		<div class="row cl" style="margin-top: 35px;">
			<div class="col-xs-8 col-sm-9 col-xs-offset-4 ">
				<input class="btn btn-primary radius" type="submit" id="Btn" value="提交修改">
			</div>
		</div>
	</form>
</article>

<!--_footer 作为公共模版分离出去-->
<script type="text/javascript" src="lib/jquery/1.9.1/jquery.min.js"></script> 
<script type="text/javascript" src="lib/layer/2.4/layer.js"></script>
<script type="text/javascript" src="static/h-ui/js/H-ui.js"></script>
<script type="text/javascript" src="static/h-ui.admin/js/H-ui.admin.page.js"></script>
<!--/_footer /作为公共模版分离出去-->

<!--请在下方写此页面业务相关的脚本-->
<script type="text/javascript" src="lib/My97DatePicker/4.8/WdatePicker.js"></script>
<script type="text/javascript" src="lib/jquery.validation/1.14.0/jquery.validate.js"></script> 
<script type="text/javascript" src="lib/jquery.validation/1.14.0/validate-methods.js"></script> 
<script type="text/javascript" src="lib/jquery.validation/1.14.0/messages_zh.js"></script>
<script type="text/javascript" src="js/eh.js"></script>
<script src="plug/layui/layui.js"></script>
<script type="text/javascript">

$(function () {
	selectAdminInfo();
});



	/*真实姓名验证*/
$('#trueName').blur(function () {
	var tPattern=/[\u4E00-\u9FA5]{2,4}/;
	if (!tPattern.test($('#trueName').val())){
		$('#trueName').siblings('.edit-msg').html("请输入有效的真实姓名!").css("color",'orange');;
		$('#trueName').focus();
		return false;
	}else {
		$('#trueName').siblings('.edit-msg').html("已修改").css("color",'green');
	}
});



 //手机号码验证
 $('#phone').blur(function () {
	 //手机号码正则
	 var myreg = /^(((13[0-9]{1})|(15[0-9]{1})|(18[0-9]{1}))+\d{8})$/;
	 if(!myreg.test($('#phone').val())) {
	 $('#phone').siblings('.edit-msg').html("请输入有效的手机号码!").css("color",'orange');;
	 $('#phone').focus();
	 return false;
	 }else {
		 $('#phone').siblings('.edit-msg').html("已修改").css("color",'green');
 	}
 });

 //电子邮箱验证
 $('#email').blur(function () {
	 var ePattern =/[a-zA-Z0-9_-]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/;
	 if (!ePattern.test($('#email').val())){
		 $('#email').siblings('.edit-msg').html("请输入有效的电子邮箱!").css("color",'orange');;
	 $('#email').focus();
	 return false;
	 }else {
		 $('#email').siblings('.edit-msg').html("已修改").css("color",'green');
	 }

 });


	$('#Btn').click(function () {
		$.ajax({
			type: "POST",
			url: serverURL+"/admin/updateAdminInfo",
			data:$('#myform').serialize()+'&token='+localStorage.getItem("eh_token"),
			dataType:"json",
			success: function(data){
				if(data.errorCode=="500") {
					layer.msg(data.message);

				}
				if(data.errorCode=="200") {
					layer.msg(data.message);
					window.setTimeout(function () {
						window.location.reload();//重新加载页面
					},1000);
				}
			}
		});
		return false;
	})

	function selectAdminInfo() {
		$.ajax({
			type: "GET",
			url: serverURL+"/admin/getAdminInfo",
			data:{"token":localStorage.getItem("eh_token")},
			dataType:"json",
			success: function(data){
				if(data.errorCode=="500") {
					layer.msg(data.message);
					window.location.href="login.html";
				}
				if(data.errorCode=="501") {
					layer.msg(data.message);
					window.location.href="login.html";
				}
				if(data.errorCode=="200") {
					//alert(data.item.admin.trueName);

					$('#userName').html(data.item.admin.userName);
					$("#trueName").val(data.item.admin.trueName);
					var phone=data.item.admin.phone,email=data.item.admin.email;
					if (phone == null){
						$('#phone').attr('placeholder','待完善');
						$('#phone').siblings(".edit-msg").html("").css("color","#999");
					}  else {
						$('#phone').val(phone);
					}
					if (email == null ){
						$('#email').attr('placeholder','待完善');
						$('#email').siblings(".edit-msg").html("").css("color","#999");
					} else {
						$('#email').val(email);
					}

					$('#createTime').html(getLocalTime(data.item.admin.createTime));
					$('#loginLastTime').html(getLocalTime(data.item.admin.loginLastTime));
					$('#lastTime').html(getLocalTime(data.item.admin.lastTime));
					if(data.item.permissions != null){

						if(data.item.permissions.low == true){
							if(data.item.permissions.middle ==true){
								if (data.item.permissions.height == true){
									$('#permissions').html('高级级管理员');
								}else {
									$('#permissions').html('中级管理员');
								}
							}else {
								$('#permissions').html('初级管理员');
							}
						}

					}else{
						$('#permissions').html('未设置权限');
					}


				}
			}
		});
	}

	$('#updatePassword').click(function () {
		window.location.href="admin-password.html";
	});
</script> 
<!--/请在上方写此页面业务相关的脚本-->
</body>
</html>